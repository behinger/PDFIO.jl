<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Digital Signatures · PDFIO</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">PDFIO</span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../README/">PDFIO</a></li><li><a class="tocitem" href="../arch/">Architecture and Design</a></li><li><a class="tocitem" href="../encrypt/">Encryption in PDF</a></li><li class="is-active"><a class="tocitem" href>Digital Signatures</a><ul class="internal"><li><a class="tocitem" href="#Basics-of-Public-Key-Infrastructure-(PKI)"><span>Basics of Public Key Infrastructure (PKI)</span></a></li><li><a class="tocitem" href="#Digital-Certificates"><span>Digital Certificates</span></a></li><li><a class="tocitem" href="#Signature-Validity"><span>Signature Validity</span></a></li><li><a class="tocitem" href="#Digital-Signatures-in-PDF"><span>Digital Signatures in PDF</span></a></li><li><a class="tocitem" href="#API-and-its-Limitations"><span>API and its Limitations</span></a></li><li><a class="tocitem" href="#Reference"><span>Reference</span></a></li></ul></li><li><a class="tocitem" href="../">API Reference</a></li><li><a class="tocitem" href="../LICENSE/">PDFIO License</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Digital Signatures</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Digital Signatures</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/sambitdash/PDFIO.jl/blob/master/docs/src/digsig.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Digital-Signatures"><a class="docs-heading-anchor" href="#Digital-Signatures">Digital Signatures</a><a id="Digital-Signatures-1"></a><a class="docs-heading-anchor-permalink" href="#Digital-Signatures" title="Permalink"></a></h1><p>The integrity of a PDF document can be protected by using <strong>digital signatures</strong>. The signatures can be of various kinds; namely, signature images, biometric information as well as mathematical equations as in Public Key Infrastructure (PKI) based signatures. While PDF documents can support these varied signature schemes, the API designed here is only limited to the interoperable signature schemes related to PKI certificates described in the PDF specification section 12.8.3. PKI standards are fairly involved set of operations, and exhaustive explanation of these operations cannot be possible in this section. Some high level concepts are described here for the API user to get familiarity of the operations.</p><h2 id="Basics-of-Public-Key-Infrastructure-(PKI)"><a class="docs-heading-anchor" href="#Basics-of-Public-Key-Infrastructure-(PKI)">Basics of Public Key Infrastructure (PKI)</a><a id="Basics-of-Public-Key-Infrastructure-(PKI)-1"></a><a class="docs-heading-anchor-permalink" href="#Basics-of-Public-Key-Infrastructure-(PKI)" title="Permalink"></a></h2><p>When Alice wants to send a PDF document to Bob, Bob would like to understand if:</p><ol><li>Alice only sent the document</li><li>The document he got is what Alice intended to send and not a tampered version.</li></ol><p>Digital signature schemes address these problems. <strong>Public Key Infrastructure (PKI)</strong> provides one such solution to the problem. It expects Alice to own two keys, one <strong>private key (<span>$K_v$</span>)</strong>, that she has to keep absolutely secretly under her possession and a second one called <strong>public key (<span>$K_p$</span>)</strong> that she has to provide to Bob. When an information is encoded using the private key (<span>$K_v$</span>), it can only be decoded by the public key (<span>$K_p$</span>) thus <strong>verifying</strong> the operation. This is the foundation of the <strong>asymmetric cryptography</strong>.</p><p>Following are the <strong>digital signing</strong> operations as carried out by Alice:</p><ol><li>Alice creates a <strong>digest</strong> of the PDF document using a <strong>digest algorithm</strong>.<ol><li>The digest is a one way derivative of the document, that cannot be reverse engineered to get back to the original document.</li><li>The digest algorithms are such that even the slightest change in the document will have a digest that is completely different from the original digest.</li></ol></li><li>Alice encodes the digest <strong>plain text</strong> using <span>$K_v$</span>. This encoded <strong>cipher text</strong> is called the <strong>signature</strong>.</li><li>Alice embeds the signature, the digest algorithm she used in in the PDF document and sends it to Bob.</li></ol><p>Bob uses the following <strong>validation</strong> or <strong>verification</strong> steps:</p><ol><li>Bob computes the digest of the document using the same algorithm Alice used by picking up the information from the PDF.</li><li>He picks up the cipher text from the signature and applies decoding method using <span>$K_p$</span>.</li><li>The plain text thus obtained is compared with the digest generated in step 1 to ensure the document has not been tampered with.</li></ol><p>The APIs developed here are confined to the validation and verification operations only and does not encompass the signing operations.</p><h2 id="Digital-Certificates"><a class="docs-heading-anchor" href="#Digital-Certificates">Digital Certificates</a><a id="Digital-Certificates-1"></a><a class="docs-heading-anchor-permalink" href="#Digital-Certificates" title="Permalink"></a></h2><p>One problem which has still not been addressed in the previous example is how can Alice communicate to Bob her public key (<span>$K_p$</span>). This is a significant concern in the internet world as Alice and Bob may never meet in person. Secondly, Alice may have to communicate to many other people and not just Bob and such information exchange needs a standardized framework so that she can provide same information to all the people she can interact with. She can contact a <strong>certifying authority (CA)</strong> and provide her public key (<span>$K_p$</span>) and other personal details like name, contact etc. which will be signed by the private key of the CA and presented in a standardized format. The process is called <strong>issuance of certificates</strong> and the digital information Alice receives is called a <strong>X509 certificate</strong> or a <strong>certificate</strong>. Any person who has Alice&#39;s digital certificate can essentially validate the authenticity of the certificate by verifying with the CA&#39;s public key.</p><h3 id="Chain-of-Trust"><a class="docs-heading-anchor" href="#Chain-of-Trust">Chain of Trust</a><a id="Chain-of-Trust-1"></a><a class="docs-heading-anchor-permalink" href="#Chain-of-Trust" title="Permalink"></a></h3><p>In a distributed world, a single CA is hard to conceive and not scalable to issue and manage all the certificates. Thus, CAs typically establish a network of subordinate CAs who can manage certificates on their behalf by issuing additional certificates that can be used as CAs to issue further certificates downstream. This leads to one <strong>root certifying authority</strong> or <strong>root</strong> and large number of <strong>subordinate certifying authority</strong> or <strong>intermediate CA</strong>. The root CA certificate is issued by the root CA itself. This process is called <strong>self-signing</strong>. A certificate that is actually used for any operation (like signing of documents) also known as <strong>end entity certificate</strong> is <strong>trusted</strong> only when the root as well as all intermediate CA certificates that were used to validate the certificates are trust worthy. This essentially means the certificate of all such CAs will be validated against their respective CA certificates establishing a chain of trust.</p><h3 id="Trust-Store"><a class="docs-heading-anchor" href="#Trust-Store">Trust Store</a><a id="Trust-Store-1"></a><a class="docs-heading-anchor-permalink" href="#Trust-Store" title="Permalink"></a></h3><p>Any applications validating a certificate needs to maintain a trust store of certificates. A trust store must contain the root and all intermediate CA certificates to be able to validate an end entity certificates.</p><p>The API uses the file: <code>&lt;PDFIO Dir&gt;/data/certs/cacerts.pem</code> as a certificate trust store.</p><p>An end-entity certificate included in the trust store is not validated for establishing a chain of trust. Hence, is generally discouraged. However, in case of self-signed certificates this may be the only means to establish trust.</p><h3 id="Expiry-and-Revocation"><a class="docs-heading-anchor" href="#Expiry-and-Revocation">Expiry and Revocation</a><a id="Expiry-and-Revocation-1"></a><a class="docs-heading-anchor-permalink" href="#Expiry-and-Revocation" title="Permalink"></a></h3><h4 id="Importance-of-Time"><a class="docs-heading-anchor" href="#Importance-of-Time">Importance of Time</a><a id="Importance-of-Time-1"></a><a class="docs-heading-anchor-permalink" href="#Importance-of-Time" title="Permalink"></a></h4><p>Asymmetric encryption works because of the following two inherent assumptions:</p><ol><li>The digest algorithm is strong enough so that one cannot find another document that easily which will reproduce the same digest even when a large number of computing resources are provided within a reasonable time.</li><li>Knowing the public key one cannot possibly find a private key using large  number  of computing resources within a reasonable time.</li></ol><p>Hence, as computing power improves, there is a consistent need to search for algorithms that keep the assumption valid. Hence, as a policy certificates are kept ephemeral, only being valid for one to three years. As a policy of verification the time validity of all the certificates are reviewed as well.</p><h4 id="Certificate-Revocation"><a class="docs-heading-anchor" href="#Certificate-Revocation">Certificate Revocation</a><a id="Certificate-Revocation-1"></a><a class="docs-heading-anchor-permalink" href="#Certificate-Revocation" title="Permalink"></a></h4><p>A valid certificate can be <strong>revoked</strong> by a CA if it&#39;s found that the certificate was compromised in some manner. A compromise includes exposure of private key by any means to any undesirable party. Such information can be periodically updated in a ledger by a CA that can be downloaded by the clients. These are called as <strong>Certificate Revocation Lists (CRL)</strong>. With internet being so much more popular the certificates can be queried with the CA intermittently for their validity using the <strong>Online Certificate Security Protocol (OCSP)</strong> rather than a lookup on the cached CRLs. Certificate validation process includes referring to the said databases for revocation information.</p><h2 id="Signature-Validity"><a class="docs-heading-anchor" href="#Signature-Validity">Signature Validity</a><a id="Signature-Validity-1"></a><a class="docs-heading-anchor-permalink" href="#Signature-Validity" title="Permalink"></a></h2><p>Signature in a document is said to be valid when:</p><ol><li>The certificate which it&#39;s to be validated against is valid when the signature was computed. This shall mean:<ol><li>The certificate had not expired</li><li>The certificate had not been revoked by the issuing CA</li><li>A complete trust chain can be established of valid certificates</li></ol></li><li>It can be established the signature was originated from the content that it claims to represent.</li><li>The certificate used for signing is the valid certificate for the purpose, policy defined and of the profiles that such a certificate should have. <strong>Purpose</strong>, <strong>policy</strong> and <strong>profile</strong> mandate certain <strong>attributes</strong> that must be defined in a certificate. They also establish certain constraints in their relationships.</li></ol><p>Since, time is an important factor in validating certificates, the same can affect signatures as well. Signatures can be validated at the time when they were generated if such information is available with the document. Otherwise, the signatures are validated in the current time.</p><h2 id="Digital-Signatures-in-PDF"><a class="docs-heading-anchor" href="#Digital-Signatures-in-PDF">Digital Signatures in PDF</a><a id="Digital-Signatures-in-PDF-1"></a><a class="docs-heading-anchor-permalink" href="#Digital-Signatures-in-PDF" title="Permalink"></a></h2><p>As per the PDF specification, the following functions can be carried out with signing of PDF files:</p><ol><li>Signing and embedding a signature in the document</li><li>Validation of the signature</li><li>Granular control of PDF document objects based on the permissions enabled with validation of a signature. (DocMDP, UR and FieldMDP)</li><li>Incremental updates to the document with changes preserved for authoritative version management.</li><li>Defining a document secured store and populating validation related information (PDF-2.0).</li><li>Creating a document time stamp and ensuring that is updated effectively for long time validation of signatures when the certificates may expire or become invalid due to weaker cipher specification in them (PDF-2.0).</li></ol><h2 id="API-and-its-Limitations"><a class="docs-heading-anchor" href="#API-and-its-Limitations">API and its Limitations</a><a id="API-and-its-Limitations-1"></a><a class="docs-heading-anchor-permalink" href="#API-and-its-Limitations" title="Permalink"></a></h2><p>The API provided here is a single method <a href="../#PDFIO.PD.pdDocValidateSignatures"><code>pdDocValidateSignatures</code></a>. The method provides the following two functionalities:</p><ol><li>Scans the PDF document for approval signatures appearing in the document as form fields and validates those. For each such signature it returns a status dictionary with certificate details, pass status of the validation or failures and failure reasons if any.</li><li>Given an optional parameter, exports all the certificates embedded in the PDF document so that the they can be reviewed and intermediate and root certificates can be picked up and added to the trusted certificate store.</li></ol><p>The functionality in terms of validation is fairly basic and does not  review the policies, profiles or purpose of the certificates.</p><h2 id="Reference"><a class="docs-heading-anchor" href="#Reference">Reference</a><a id="Reference-1"></a><a class="docs-heading-anchor-permalink" href="#Reference" title="Permalink"></a></h2><ol><li>Digital Signature article on <a href="https://en.wikipedia.org/wiki/Digital_signature">Wikipedia</a></li><li>Adobe Systems Inc. (2008) Document Management - Portable Document Format - Part 1: PDF 1.7, retrieved from <a href="https://www.adobe.com/devnet/pdf/pdf_reference.html">Adobe</a>.</li></ol></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../encrypt/">« Encryption in PDF</a><a class="docs-footer-nextpage" href="../">API Reference »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Wednesday 21 July 2021 16:57">Wednesday 21 July 2021</span>. Using Julia version 1.6.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
